---
description: 変更内容をcommitしてpushする。
  「pushして」「コミットしてpush」「変更をプッシュ」「push」などのリクエストで使用。
---

# Push

変更内容をcommitしてリモートにpushする。

## 処理フロー

### 1. 状態確認

以下を並列で実行:

| コマンド | 目的 |
|---------|------|
| `git status` | 変更ファイルの一覧 |
| `git diff` | unstaged変更の内容 |
| `git diff --staged` | staged変更の内容 |
| `git branch --show-current` | 現在のブランチ名 |
| `git log --oneline -5` | 直近のコミットメッセージ（スタイル参考） |

変更がない場合は「変更なし」と報告して終了。

### 2. ブランチ確認

| 状況 | 対応 |
|------|------|
| main/masterブランチ上 | ユーザーに確認してから続行 |
| それ以外のブランチ | そのまま続行 |

### 3. コミット前チェック

プロジェクトにリンター・テストがある場合は実行する。

| 結果 | 対応 |
|------|------|
| パス | 次のステップへ |
| 失敗 | 問題を修正してから再実行 |
| リンター・テストなし | スキップ |

### 4. コミット粒度の判断

Conventional Commits形式に従い、変更の種類でコミットを分割する。

| 状況 | 対応 |
|------|------|
| 単一種類の変更 | 1コミットにまとめる |
| 複数種類が混在 | 種類ごとに別コミット |

例: `docs`の変更と`feat`の変更 → `docs`を先にコミット → `feat`をコミット

### 5. コミット作成

各コミットで以下を実行:

1. `git add`で対象ファイルをステージ（`git add .`は避ける）
2. `git diff --staged`で秘匿情報（API key、パスワード、トークン等）がないか確認
3. 秘匿情報を検出 → ユーザーに報告し中止
4. コミットメッセージを作成してコミット

### 6. Push

1. リモート追跡の確認

| 状況 | コマンド |
|------|---------|
| 追跡ブランチあり | `git push` |
| 追跡ブランチなし | `git push -u origin {branch}` |

2. 結果の報告

| 結果 | 対応 |
|------|------|
| 成功 | コミット内容のサマリーを報告 |
| 失敗 | 次のエラー処理を参照 |

## エラー処理

| エラー | 対処 |
|--------|------|
| リモートが先行（rejected） | `git pull --rebase`後に再push。コンフリクト発生時はユーザーに報告 |
| 認証エラー | 認証情報の確認を案内 |
| pre-commit hookの失敗 | hookのエラー内容を報告し、修正を提案 |
