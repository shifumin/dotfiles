# optimize-for-ai [ドキュメントパス]

指定されたドキュメントをAI向けに最適化します。

---

## 🎯 基本方針

- **3つの観点で改善**: 構造・フォーマット、文脈・意図の明確化、具体例の充実
- **元の意図を保持**: ドキュメントの目的や既存の指示内容を損なわない
- **最小限の変更**: 過剰な追加や不必要な装飾を避ける
- **読み手を意識**: AIが迷わず解釈できる明確な表現を使う

---

## 📋 実行手順

### STEP 1: ドキュメント分析

1. **Readツールでドキュメント全体を読み込む**
2. **現状を把握する**:
   - ドキュメントの目的・対象読者
   - 主要なセクション構成
   - 既存の指示や制約事項

3. **問題点を洗い出す**:
   - 以下のチェックリストに沿って改善点を特定

---

### STEP 2: 改善チェックリスト

#### ✅ チェック1: 構造・フォーマット（🟡 基本）

**チェック項目:**

| 観点 | 良い例 | 悪い例 |
|------|--------|--------|
| 見出し階層 | `# 大見出し` → `## 中見出し` → `### 小見出し` | 階層が飛ぶ、不統一 |
| 箇条書き | 記号が統一（`-` or `*`） | 混在、インデント不揃い |
| セクション分割 | 論理的なまとまりで分割 | 1セクションが長すぎる |
| 区切り線 | 大きなセクション間に `---` | 使いすぎ/使わなすぎ |
| テーブル | 情報が整理されて比較しやすい | 箇条書きで無理に列挙 |

**改善アクション:**
- 見出しレベルを `#` → `##` → `###` の順で統一
- 箇条書き記号を `-` に統一
- 長いセクション（30行超）は分割を検討
- 関連する情報はテーブルにまとめる

---

#### ✅ チェック2: 文脈・意図の明確化（🔴 重要）

**チェック項目:**

| 観点 | 良い例 | 悪い例 |
|------|--------|--------|
| 背景説明 | 「〇〇のため、△△する」 | 「△△する」のみ |
| 適用条件 | 「〇〇の場合は」「〇〇以外は」 | 条件が曖昧 |
| 制約の理由 | 「〇〇を防ぐため」 | 「〇〇は禁止」のみ |
| 優先順位 | 「最優先」「必須」「推奨」 | 全て同じ重要度に見える |
| スコープ | 「このプロジェクトでは」 | 適用範囲が不明 |

**改善アクション:**
- 「なぜ」を1文追加（理由がない指示に追記）
- 条件分岐を明示（if/then形式で記述）
- 優先度マーカーを追加（🔴必須 / 🟡推奨 / 🟢任意）
- 例外ケースを明記

**例:**

```markdown
# ❌ 改善前
- コミット前にテストを実行する

# ✅ 改善後
- コミット前にテストを実行する
  - **理由**: CIでの失敗を事前に防ぎ、レビュー効率を上げるため
  - **例外**: ドキュメントのみの変更の場合はスキップ可
```

---

#### ✅ チェック3: 具体例の充実（🔴 重要）

**チェック項目:**

| 観点 | 良い例 | 悪い例 |
|------|--------|--------|
| 入出力例 | コマンドと期待される結果 | 説明のみ |
| 良い例/悪い例 | `✅ OK` / `❌ NG` のペア | 良い例のみ |
| コードサンプル | 言語指定付きコードブロック | インライン記述 |
| ユースケース | 具体的なシナリオ | 抽象的な説明 |
| エッジケース | 例外的な状況の対処法 | 正常系のみ |

**改善アクション:**
- 抽象的な指示には具体例を1つ以上追加
- 「〇〇しない」という禁止事項には悪い例を追加
- コードは必ず言語指定付きコードブロックで記述
- 使用例セクションを追加（コマンドドキュメントの場合）

**例:**

```markdown
# ❌ 改善前
## ファイル作成
日本語ファイル名はWriteツールで作成する。

# ✅ 改善後
## ファイル作成

日本語ファイル名はWriteツールで作成する。

**理由**: `touch`コマンドは文字化けの原因になるため。

**例:**
```bash
# ❌ NG: touchコマンド（文字化け）
touch "日記_2025-01-01.md"

# ✅ OK: Writeツール
Write: 日記_2025-01-01.md
```
```

---

### STEP 3: 編集の実施

1. **Editツールで改善を適用**
   - 優先度の高い問題から順に修正
   - 1回の編集で関連する改善をまとめて適用

2. **変更内容を記録**
   - 何を改善したかをメモ

---

## 📊 出力フォーマット

編集完了後、以下の形式でサマリーを出力:

```
## ドキュメント最適化完了

**対象ファイル**: [ファイルパス]

### 改善内容

#### 構造・フォーマット
- [改善項目1]
- [改善項目2]

#### 文脈・意図の明確化
- [改善項目1]
- [改善項目2]

#### 具体例の追加
- [改善項目1]
- [改善項目2]

### 改善前後の比較（主要な変更点）

[必要に応じて変更前後を示す]
```

---

## ❌ 制約事項

### 禁止事項

1. **元の意図を変更する**
   - 指示内容の意味を変えない
   - 削除は最小限に（冗長な繰り返しのみ）

2. **過度な装飾を追加する**
   - 不必要な絵文字を増やさない
   - 見出しレベルを深くしすぎない（4階層以上は避ける）

3. **推測で情報を追加する**
   - 確認できない背景情報を捏造しない
   - 不明な点は「確認が必要」と明記

4. **大幅な構造変更を一方的に行う**
   - セクションの順序変更は慎重に
   - 既存の命名規則を尊重

### 必須事項

1. **改善の根拠を示す**
   - なぜその変更が有効かを説明できるようにする

2. **元のドキュメントを読み込んでから編集する**
   - 推測で編集しない

---

## 📚 使用例

```bash
# CLAUDE.mdを最適化
/optimize-for-ai CLAUDE.md

# カスタムコマンドを最適化
/optimize-for-ai ~/.claude/commands/push.md

# プロジェクト固有のドキュメントを最適化
/optimize-for-ai ~/project/CONTRIBUTING.md
```

---

## 💡 改善のヒント

### AIが解釈しやすいドキュメントの特徴

1. **明確な構造**: 見出しで内容が予測できる
2. **具体的な指示**: 曖昧さがない
3. **理由の明記**: なぜそうするかが分かる
4. **例示**: 具体的なサンプルがある
5. **例外の明記**: エッジケースが分かる
6. **優先順位**: 重要度が判別できる

### よくある改善パターン

| パターン | 改善前 | 改善後 |
|----------|--------|--------|
| 理由なし指示 | 「〇〇する」 | 「〇〇する（△△のため）」 |
| 曖昧な条件 | 「必要に応じて」 | 「〇〇の場合は」 |
| 例なし | 説明のみ | 説明 + コード例 |
| 禁止のみ | 「〇〇しない」 | 「〇〇しない」+ ❌NG例 |
| フラット構造 | 箇条書きの羅列 | セクション分割 |
