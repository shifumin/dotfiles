# CLAUDE.md

このドキュメントは、Claude Codeを使用する際の必須ガイドラインです。以下の指示に必ず従ってください。

## 🚨 重要な原則

1. **既存のコードスタイルを厳守する** - プロジェクトの規約から逸脱しない
2. **プロジェクトのツールを使用する** - 新しいツールやフレームワークを勝手に導入しない
3. **コミット前の必須チェック** - リンターとテストを必ず実行する
4. **テストの同期** - 実装を追加・変更した場合は、対応するテストも必ず追加・変更する
5. **ドキュメントの更新** - 必要に応じてREADME.mdとCLAUDE.mdを更新する
6. **CLAUDE.mdへの記載形式** - CLAUDE.mdに内容を追加する際は、Claude Codeが理解しやすい明確で構造化された形式で記載する

## 📋 作業前チェックリスト

- [ ] README.mdを読んだか？
- [ ] 既存のコードパターンを理解したか？
- [ ] 使用可能なツールとコマンドを確認したか？
- [ ] テストの実行方法を確認したか？

## 🛠️ 言語別コマンドリファレンス

### 共通原則
- プロジェクトで使用されているツールを確認する（package.json、Gemfile、requirements.txt等）
- 既存のスクリプトやコマンドを優先的に使用する
- プロジェクト固有の設定ファイルに従う

### Ruby

#### 必須コマンド
```bash
# リンター実行（コミット前に必須）
rubocop

# 自動修正
rubocop -a  # または rubocop --auto-correct

# テスト実行（コミット前に必須）
rspec  # または bundle exec rspec
```

#### バージョン管理
1. `.ruby-version`ファイルでRubyバージョンを指定
2. `Gemfile`で`.ruby-version`を参照:
   ```ruby
   ruby File.read('.ruby-version').strip
   ```

#### テスト実行パターン
```bash
# 全テスト実行
rspec

# 特定ファイルのテスト
rspec spec/path/to/spec_file.rb

# 特定行のテスト
rspec spec/path/to/spec_file.rb:42
```

#### コーディング規約
- プロジェクトの`.rubocop.yml`に従う
- 既存のコードパターンを踏襲する

### その他の言語

#### 基本的な確認項目
- **リンター/フォーマッター**: プロジェクトで使用されているツールを確認
- **テストフレームワーク**: テストの実行方法を確認
- **ビルドツール**: ビルドやコンパイルの方法を確認
- **パッケージマネージャー**: 依存関係の管理方法を確認

#### コマンド例（プロジェクトに応じて調整）
```bash
# JavaScript/TypeScript
npm run lint / npm test

# Python
ruff check / pytest

# Go
go fmt / go test

# Java
mvn checkstyle:check / mvn test
```

## 🔄 標準ワークフロー

### 1. 作業開始前
```bash
# 現在の状態を確認
git status
git diff

# テストが通ることを確認
# [プロジェクトのテストコマンド]
# 例: rspec, npm test, pytest, go test 等
```

### 2. 実装中
- 既存パターンに従う
- エラーハンドリングを実装
- テストを同時に作成・更新
- **実装変更後は必ずテストを実行** - 変更した機能に関連するテストが通ることを確認

### 3. 作業完了前
```bash
# リンター実行
# [プロジェクトのリンターコマンド]

# テスト実行
# [プロジェクトのテストコマンド]

# 変更内容の確認
git diff
```

## ⚠️ 絶対に避けるべきこと

- ❌ セキュリティキーや認証情報をコードに含める
- ❌ `.env`ファイルや設定ファイルの機密情報をコミットする
- ❌ テストなしで実装をコミットする
- ❌ リンターエラーを無視する
- ❌ 既存の命名規則から逸脱する

## 🔧 トラブルシューティング

### よくあるエラーと対処法

#### テスト失敗時
```bash
# 特定のテストのみ実行して原因を特定
# [プロジェクトのテストコマンド] [失敗したテストファイル] [オプション]

# Ruby例:
rspec spec/failing_spec.rb -fd
rspec --only-failures
```

#### リンターエラー時
```bash
# 自動修正を試みる
# [プロジェクトのリンターコマンド] [自動修正オプション]

# Ruby例:
rubocop -a
rubocop path/to/file.rb
```

#### 依存関係エラー時
```bash
# 依存関係をインストール
# [プロジェクトのパッケージマネージャー] install

# Ruby例:
bundle install
bundle update gem_name
```

## 📝 プロジェクト固有の設定

プロジェクト固有の追加情報がある場合は、以下に記載してください：

---

**注意**: このドキュメントの指示は、デフォルトの動作よりも優先されます。必ず従ってください。